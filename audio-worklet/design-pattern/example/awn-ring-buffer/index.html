<!DOCTYPE html>
<html>
<head>
  <title>AudioWorkletNode (internal buffering) | Examples | WebAudio + WASM</title>
</head>
<body>
  <a href="../index.html">Example Index</a>
  <h1>AudioWorkletNode (internal buffering)</h1>
  <button id="start-audio">Start Audio</button>
  <script>
    const context = new AudioContext();
    context.audioWorklet.addModule('ring-buffer-worklet-module.js').then(() => {
      let osc = new OscillatorNode(context);
      let ringBufferWorkletNode =
          new AudioWorkletNode(context, 'ring-buffer-worklet-processor', {
            processorOptions: {
              kernelBufferSize: 1024,
              channelCount: 1
            }
          });

      context.suspend();
      osc.connect(ringBufferWorkletNode).connect(context.destination);
      osc.start();

      // For simple toggle mechanism.
      const eButton = document.getElementById('start-audio');
      eButton.onclick = () => {
        if (eButton.textContent === 'Start Audio') {
          context.resume();
          eButton.textContent = 'Stop Audio';
        } else {
          context.suspend();
          eButton.textContent = 'Start Audio';
        }
      };
    });
  </script>
</body>
</html>
